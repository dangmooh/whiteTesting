cmake_minimum_required(VERSION 3.10)
project(WhiteBoxCProject C CXX)

set(CMAKE_C_STANDARD 99)

# ğŸ”§ ëŸ°íƒ€ì„ ì˜µì…˜ /MDdë¡œ í†µì¼
foreach(flag_var
    CMAKE_C_FLAGS_DEBUG
    CMAKE_CXX_FLAGS_DEBUG
    CMAKE_C_FLAGS_RELEASE
    CMAKE_CXX_FLAGS_RELEASE)
  string(REPLACE "/MT" "/MD" ${flag_var} "${${flag_var}}")
endforeach()

# âœ… GoogleTest ì„¤ì • (ë™ì  CRT ê°•ì œ)
include(FetchContent)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # í•µì‹¬
FetchContent_Declare(
  googletest
  GIT_REPOSITORY https://github.com/google/googletest.git
  GIT_TAG release-1.12.1
)
FetchContent_MakeAvailable(googletest)

include_directories(src)

# ë¼ì´ë¸ŒëŸ¬ë¦¬ + í…ŒìŠ¤íŠ¸ íƒ€ê²Ÿ ìƒì„±
add_library(calc src/calc.c)
add_executable(test_calc tests/test_calc.cpp)
target_link_libraries(test_calc gtest_main calc)

# í…ŒìŠ¤íŠ¸ ìë™ ë“±ë¡
enable_testing()
include(GoogleTest)
gtest_discover_tests(test_calc)
